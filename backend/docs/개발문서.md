# 코스픽 백엔드 개발 문서

## 1. 기술 스택

### 1.1 개발 환경

- **언어**: Java 21
- **프레임워크**: Spring Boot 3.5.3
- **빌드 도구**: Gradle 8.14.2

### 1.2 주요 라이브러리

```
- Spring Data ?
- Spring Web
```

## 2. 아키텍쳐 패턴

### 2.1 아키텍쳐 패턴

- **레이어드 아키텍쳐 패턴**을 사용한다.
  - 가장 간단하면서도, 도메인의 순수함을 지킬 수 있는 아키텍쳐이기 때문이다.

![아키텍쳐 그림.png](%EC%95%84%ED%82%A4%ED%85%8D%EC%B3%90%20%EA%B7%B8%EB%A6%BC.png)

### 2.2 레이어별 설명

**프레젠테이션 레이어**

- API를 구성하고 HTTP 요청/응답을 한다.
- Request를 받는다.
- Response를 응답한다.

**애플리케이션 레이어**

- 트랜잭션을 건다.
- 하나의 작업 단위를 구성한다.
- 도메인 모델들이 협력할 수 있도록 한다.
- 원시값들을 받는다.
- 도메인 엔티티를 반환한다.

**도메인**

- 비즈니스 로직을 실제로 수행한다.
  - 원시값들을 받는다.

## 3. 패키지 구조

```
- application: 애플리케이션 레이어에 해당하는 객체
- domain: 도메인 레이어에 해당하는 객체
- presentation: 프레젠테이션 레이어에 해당하는 객체
```

- 위 구조를 기본으로 두고, 각 레이어에 해당하는 클래스들을 둔다.
- 한 레이어에 수정 주기가 다른 여러 객체들이 모이면(`Map`, `Member` 등) 각 관심사 별로 패키지를 분리한다.

## 4. 검증 방법

- 애플리케이션 서비스에서 파라미터에 검증 애노테이션을 통해 검증한다.
- NonNull 과 같은 기본적인 검증은 SonarLint 익스텐션을 사용하여 검증한다.

## 5. 에러 처리

- 커스텀 예외를 만들되, 너무 세분화하지 말고 상황에 따라 나눈다.
  - ex) `NotFoundException`, `InvalidCreationArgumentException`
- 각 상황에 맞는 세분화된 ErrorType 열거형 상수를 만든다.
- 각 커스텀 예외는 생성시 해당 열거형 상수를 받도록 한다.
- 클라이언트에게 응답할 때에는 해당 열거형 상수를 같이 보낸다.

```json
{
  "code": 404,
  "message": "회원을 찾을 수 없습니다.",
  "errorType": "MEMBER_NOT_FOUND",
  "exceptionType": "NotFoundException",
  "timestamp": "2024-01-15T10:30:00Z"
}
```

## 6. 테스트 전략

- 도메인 레이어는 풍부한 Junit 기반 단위테스트를 작성한다.
- 애플리케이션 레이어는 `@SpringBootTest` 사용하여 통합테스트를 작성한다.
  - 외부 API 호출은 목으로 대체한다.
  - 직접 DB에 접근하여 데이터를 롤백한다.
- 영속성 레이어는 헷갈리면 통합테스트를 작성한다.

## 7. 배포 및 운영 전략

## 8. 모니터링 및 로깅
